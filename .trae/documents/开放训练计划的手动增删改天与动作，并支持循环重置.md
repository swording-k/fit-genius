## 需求目标
- 在训练计划中，用户可手动：
  1) 为某天新增/删除动作
  2) 新增训练日（训练/休息日）
  3) 删除某个训练日（并自动重排 dayNumber）
- 修改后，后续所有循环都沿用更新后的结构
- 每次完成一个循环后，点击“开始新循环”重置本周期日期并清空各动作的勾选状态

## 现状与差距
- 已支持：编辑动作、滑动删除动作（Views/Plan/WorkoutDayDetailView.swift:136–142、159–166）
- 缺失：新增动作的入口、增删整天的入口与逻辑、循环起始与勾选重置的便捷操作

## 界面与交互改动
### 1) 在训练日详情中新增动作入口
- 文件：Views/Plan/WorkoutDayDetailView.swift
- 改动：
  - 在标题区域右侧添加“新增动作”按钮（`plus.circle.fill`）
  - 点按后弹出“新增动作”表单（沿用 `ExerciseEditSheet` 的 UI 结构，或创建 `ExerciseCreateSheet`），字段：名称、组数、次数、重量、备注
  - 保存：构造 `Exercise`，`newExercise.workoutDay = workoutDay`，`workoutDay.exercises.append(newExercise)`，`modelContext.insert(newExercise)`，`try modelContext.save()`

### 2) 在计划仪表盘中增删训练日
- 文件：Views/Plan/PlanDashboardView.swift
- 改动：
  - 顶部右侧工具按钮改为菜单（`ellipsis.circle`），提供：
    - “新增训练日”→ 弹出 Sheet 选择 `focus`（BodyPartFocus）、是否为休息日、默认动作数量（可选）。保存时：
      - `let nextNumber = (plan.days.map(\_.dayNumber).max() ?? 0) + 1`
      - 创建 `WorkoutDay(dayNumber: nextNumber, focus: 选项, isRestDay: 选项)`，`day.plan = plan`，`plan.days.append(day)`，`modelContext.insert(day)`，`save()`
    - “删除当前天”→ 二次确认后：
      - 从 `plan.days` 移除该日并 `modelContext.delete(day)`
      - 对剩余天按升序重排 dayNumber（1..n），确保连续：`for (idx, d) in sorted.enumerated() { d.dayNumber = idx+1 }`，`save()`
  - UI：删除后自动把 `selectedDayIndex` 调整到邻近有效索引

### 3) 开始新循环（重置日期与勾选）
- 文件：Views/Plan/PlanDashboardView.swift
- 改动：
  - 在计划信息区或菜单增加“开始新循环”
  - 动作：
    - `workoutPlan.creationDate = Date()`
    - 遍历所有 `plan.days` 的所有 `exercise`：`isCompleted = false`、`lastCompletedDate = nil`
    - `save()`
- 作用：`getTodayCyclePosition()` 与日期展示会以新起点计算，下一个循环的日期自动递推；勾选状态全部清空，重新勾选

## 数据与逻辑一致性
- 增删天后：
  - 保持 `dayNumber` 连续，`cycleDays = days.count` 自动生效
  - 若当天被删除，`todayDayIndex` 与 Tab 切换安全处理
- 增删动作：
  - 使用显式 `insert` 与 `save`，确保 SwiftData 跟踪
- 循环重置：
  - 不删除历史 `ExerciseLog`，仅重置勾选标志；历史保留

## 验证用例
- 新增/删除动作：在非休息日添加、编辑、删除，刷新后仍存在
- 新增/删除天：新增一个休息日与一个训练日；删除中间某天，确认 dayNumber 连续且 UI 可正常切换
- 循环重置：点击后计划信息显示“循环第 1 周 · 第 1 天”，所有动作勾选清空；完成一天后勾选与日志照常写入

## 迭代建议
- 日级别的“复制这一天”快捷键（复制动作列表）以加速自定义
- 新增天时可选“根据 focus 自动推荐 3 个基础动作”（可后续接入 AI 的建议模式）

请确认以上方案，我将开始实现：为 WorkoutDayDetailView 增加“新增动作”入口；为 PlanDashboardView 增加“新增训练日/删除当前天/开始新循环”功能；并完善保存与重排逻辑。